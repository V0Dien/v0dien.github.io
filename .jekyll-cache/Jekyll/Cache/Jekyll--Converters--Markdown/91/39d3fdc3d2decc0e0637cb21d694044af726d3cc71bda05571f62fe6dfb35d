I"§<p><img src="/assets/img/blog/0_avarta.png" alt="IMG" /></p>

<p>The way how I solved Traverxec machine.</p>
<h2 id="0x01-accessshell">0x01: AccessÂ shell</h2>
<p>The first step I always do is using Nmap to scan for open port(s) and service(s):</p>

<div class="language-bash highlighter-rouge"><div class="highlight"><pre class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
</pre></td><td class="rouge-code"><pre><span class="nv">$ </span>nmap <span class="nt">-sV</span> <span class="nt">-sT</span> <span class="nt">-sC</span> 10.10.10.165
</pre></td></tr></tbody></table></code></pre></div></div>
<p>And the output is:
<img src="/assets/img/blog/1_nmap.png" alt="IMG" /></p>

<p>Letâ€™s check the website:</p>

<p><img src="/assets/img/blog/2_website.png" alt="IMG" /></p>

<p>After checking and taking a look around the website, I realized this is just a static website. Then I googled for nostromo 1.9.6 exploitation, and got RCE vuln at this version. You can use the exploit payload at exploit-db. And letâ€™s access bash:</p>

<p><img src="/assets/img/blog/3_accessbash.png" alt="IMG" /></p>

<h2 id="0x02-accessuser">0x02: AccessÂ user</h2>

<p>Normally, source code of a website is usually saved at <code class="language-plaintext highlighter-rouge">/var</code> directory, I checked with ls command and got the nostromo folder. Going to the conf folder, I found  <code class="language-plaintext highlighter-rouge">nhttpd.conf</code>.</p>

<p><img src="/assets/img/blog/4_conf.png" alt="IMG" /></p>

<p>And I think a lot of people will be stuck at this step like me. That is reading .htpasswd then decode it and use it like a ssh password.</p>

<p>But read carefully once again, I realize the homedirs is <code class="language-plaintext highlighter-rouge">/home</code></p>

<p>And ls at <code class="language-plaintext highlighter-rouge">/home</code> only has a david folder. With .htpasswd above, I think maybe <code class="language-plaintext highlighter-rouge">public_www</code> folder can exist inside the david folder.</p>

<div class="language-bash highlighter-rouge"><div class="highlight"><pre class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
</pre></td><td class="rouge-code"><pre><span class="nv">$ </span><span class="nb">cd</span> /home/david/public_www
</pre></td></tr></tbody></table></code></pre></div></div>

<p>And yes, itâ€™s worked:</p>

<p><img src="/assets/img/blog/5_worked.png" alt="IMG" /></p>

<p>Letâ€™s open <code class="language-plaintext highlighter-rouge">protected-file-area</code> folder
<img src="/assets/img/blog/6_ls.png" alt="IMG" /></p>

<p>We have a .tgz file, but canâ€™t extract it because we can only read it. Ok, letâ€™s read it by zcat: Got private_key, letâ€™s find the passphrase with john.</p>

<p><img src="/assets/img/blog/7_zcat.png" alt="IMG" /></p>

<div class="language-bash highlighter-rouge"><div class="highlight"><pre class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
</pre></td><td class="rouge-code"><pre><span class="nv">$ </span>python ssh2john.py david_key <span class="o">&gt;</span> david_key.hash
<span class="nv">$ </span>john <span class="nt">--wordlist</span><span class="o">=</span>/root/Downloads/rockyou.txt <span class="nt">--format</span><span class="o">=</span>SSH david_key.hash
</pre></td></tr></tbody></table></code></pre></div></div>
<p>And the passphrase is: <code class="language-plaintext highlighter-rouge">hunter</code></p>

<h2 id="0x03-accessroot">0x03: AccessÂ root</h2>

<p>In <code class="language-plaintext highlighter-rouge">/home/david/bin</code> folder, we have 2 files:</p>

<p><img src="/assets/img/blog/8_ls.png" alt="IMG" /></p>

<p>Letâ€™s read <code class="language-plaintext highlighter-rouge">server-stats.sh</code>:
<img src="/assets/img/blog/9_serverstarts.png" alt="IMG" />
I easily realize that journalctl is running at root.
Looking at GTFOBins,journalctl can used to escalate privileges attack if itâ€™s running at root.
The way to trick is make terminal smaller and typeÂ <code class="language-plaintext highlighter-rouge">!/bin/sh</code>:</p>

<p><img src="/assets/img/blog/10_root.png" alt="IMG" />
Tada!</p>

<p>So that concluded how I solved the machine. Hope that you learned something new with this writeup.</p>

<p>Cheers! ğŸ‘</p>

<p>P/S: Thank you GinaTU aka Tá»© Diá»‡p Tháº£o to help me edit this post</p>

:ET