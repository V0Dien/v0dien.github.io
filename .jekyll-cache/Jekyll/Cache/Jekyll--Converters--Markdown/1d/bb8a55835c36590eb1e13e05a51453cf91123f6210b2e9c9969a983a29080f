I"9<h2 id="table-tennis">table-tennis</h2>

<p>Sá»­ dá»¥ng wireshark, mÃ¬nh tháº¥y cÃ³ khÃ¡ nhiá»u certificate, tuy nhiÃªn nhÆ°ng chá»©ng chá»‰ nÃ y khÃ´ng lÃ m Ä‘Æ°á»£c gÃ¬ cáº£. VÃ  sá»‘ lÆ°á»£ng gÃ³i tin cÅ©ng khÃ¡ nhiá»u nÃªn mÃ¬nh vÃ o Statistics -&gt; Conversations Ä‘á»ƒ xem cÃ¡c káº¿t ná»‘i.</p>

<p><img src="/assets/img/blog/BSidesSF2019-1.PNG" alt="IMG" /></p>

<p>Sau khi filter cÃ¡c káº¿t ná»‘i cá»§a máº¡ng 172.217.5.100 vÃ  172.217.0.36 mÃ¬nh tháº¥y ráº±ng Ä‘Ã³ lÃ  cÃ¡c gÃ³i tin ICMP, request vÃ  reply data cÃ³ Ä‘á»u cÃ³ chá»©a mÃ£ base64, vÃ¬ khÃ´ng rÃ nh vá» thÆ° viá»‡n scappy láº¯m vÃ  má»™t pháº§n lÃ  chuá»—i cÅ©ng khÃ¡ ngáº¯n nÃªn mÃ¬nh quyáº¿t Ä‘á»‹nh lÃ  lÃ m báº±ng tay.</p>

<p><img src="/assets/img/blog/BSidesSF2019-2.PNG" alt="IMG" /></p>

<p>VÃ  chá»‰ sau chá»«ng 5 phÃºt mÃ¬nh Ä‘Ã£ cÃ³ Ä‘Æ°á»£c Ä‘oáº¡n base64 hoÃ n chá»‰nh:</p>

<blockquote>
  <p>Q1RGe0p1c3RBMHV0UDFuUzBuZ0FiZ1Awbmd9</p>
</blockquote>

<p>Flag: CTF{JustA0utP1nS0ngAbgP0ng}</p>

<h2 id="goodlusk1">goodlusk1</h2>

<p>Ban tá»• chá»©c cho mÃ¬nh má»™t file img nÃªn mÃ¬nh dÃ¹ng Autospy Ä‘á»ƒ má»Ÿ. BÃªn trong chá»©a má»™t file LUKS vÃ  khÃ´ng cÃ³ gÃ¬ khÃ¡c nÃªn mÃ¬nh extract file Ä‘Ã³ ra. Google cho mÃ¬nh biáº¿t Ä‘Ã³ lÃ  file á»• Ä‘Ä©a Ä‘Ã£ bá»‹ mÃ£ hÃ³a cá»§a há»‡ Ä‘iá»u hÃ nh Linux nÃªn mÃ¬nh coppy vÃ o mÃ¡y áº£o Linux Ä‘á»ƒ thá»±c hiá»‡n.</p>

<div class="language-bash highlighter-rouge"><div class="highlight"><pre class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
</pre></td><td class="rouge-code"><pre><span class="nv">$ </span><span class="nb">sudo </span>cryptsetup open <span class="nt">--type</span> luks b.luks <span class="nb">test</span>
</pre></td></tr></tbody></table></code></pre></div></div>

<p>VÃ  dÄ© nhiÃªn vÃ¬ lÃ  file Ä‘Ã£ mÃ£ hÃ³a nÃªn mÃ¬nh cáº§n 1 password. File áº£nh kÃ¨m theo cho chÃºng ta gá»£i Ã½ vá» password vÃ  sau khi search tung google vÃ  nhÃ¬n tháº­t ká»¹ vÃ o bá»©c anh, mÃ¬nh Ä‘Ã£ tÃ¬m ra Ä‘Ã³ lÃ  EFF passphrase. Äá»ƒ so khá»›p vá»›i cÃ¡c sá»‘ Ä‘Ã£ cho mÃ¬nh dÃ¹ng link nÃ y Ä‘á»ƒ cÃ³ Ä‘Æ°á»£c password. Password lÃ </p>

<p><code class="language-plaintext highlighter-rouge">wages upturned flogging rinse landmass number</code></p>

<p>Sau khi cÃ³ Ä‘Æ°á»£c password mount á»— Ä‘Ä©a vÃ  mÃ¬nh cÃ³ Ä‘Æ°á»£c flag.</p>

<p>Flag: CTF{Look_Under_Keyboards_4_Secrets}</p>

<h2 id="thekey">thekey</h2>

<p>Má»™t file pcap báº¯t gÃ³i tin bÃ n phÃ­m nháº­p vÃ o, má»™t dáº¡ng khÃ¡ phá»• biáº¿n. Vá» tÃ i liá»‡u cÃ¡c báº¡n cÃ³ thá»ƒ tham kháº£o táº¡i <a href="https://www.usb.org/sites/default/files/documents/hut1_12v2.pdf">Ä‘Ã¢y</a>. Trong file pcap á»Ÿ cá»™t left over data sáº½ cho chÃºng ta biáº¿t Ä‘Æ°á»£c mÃ£ hex cá»§a kÃ½ tá»± Ä‘Æ°Æ¡c nháº­p vÃ o sau Ä‘Ã³ so sÃ¡nh trong báº£ng kÃ½ tá»± cá»§a tÃ i liá»‡u mÃ  mÃ¬nh Ä‘á»ƒ á»Ÿ trÃªn Ä‘á»ƒ decode ra Ä‘Æ°á»£c phÃ­m nÃ o Ä‘Ã£ Ä‘Æ°á»£c nháº­p.</p>

<p><img src="/assets/img/blog/BSidesSF2019-3.PNG" alt="IMG" /></p>

<p><img src="/assets/img/blog/BSidesSF2019-4.PNG" alt="IMG" /></p>

<p>Tuy nhiÃªn scappy cÃ³ há»— trá»£ cho nÃªn mÃ¬nh dÃ¹ng scappy. Source code:</p>

<div class="language-python highlighter-rouge"><div class="highlight"><pre class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
5
6
7
8
9
10
11
12
13
14
15
16
17
18
19
20
21
22
23
24
25
26
27
28
29
30
31
32
33
34
35
36
37
38
39
40
41
42
43
44
45
46
47
48
49
50
51
52
53
54
55
56
57
58
59
60
</pre></td><td class="rouge-code"><pre><span class="c1">#!/usr/bin/python
</span><span class="kn">from</span> <span class="nn">scapy.all</span> <span class="kn">import</span> <span class="o">*</span>
 
<span class="n">KEY_CODES</span> <span class="o">=</span> <span class="p">{</span>
<span class="mi">4</span><span class="p">:</span><span class="s">"A"</span><span class="p">,</span>
<span class="mi">5</span><span class="p">:</span><span class="s">"B"</span><span class="p">,</span>
<span class="mi">6</span><span class="p">:</span><span class="s">"C"</span><span class="p">,</span>
<span class="mi">7</span><span class="p">:</span><span class="s">"D"</span><span class="p">,</span>
<span class="mi">8</span><span class="p">:</span><span class="s">"E"</span><span class="p">,</span>
<span class="mi">9</span><span class="p">:</span><span class="s">"F"</span><span class="p">,</span>
<span class="mi">10</span><span class="p">:</span><span class="s">"G"</span><span class="p">,</span>
<span class="mi">11</span><span class="p">:</span><span class="s">"H"</span><span class="p">,</span>
<span class="mi">12</span><span class="p">:</span><span class="s">"I"</span><span class="p">,</span>
<span class="mi">13</span><span class="p">:</span><span class="s">"J"</span><span class="p">,</span>
<span class="mi">14</span><span class="p">:</span><span class="s">"K"</span><span class="p">,</span>
<span class="mi">15</span><span class="p">:</span><span class="s">"L"</span><span class="p">,</span>
<span class="mi">16</span><span class="p">:</span><span class="s">"M"</span><span class="p">,</span>
<span class="mi">17</span><span class="p">:</span><span class="s">"N"</span><span class="p">,</span>
<span class="mi">18</span><span class="p">:</span><span class="s">"O"</span><span class="p">,</span>
<span class="mi">19</span><span class="p">:</span><span class="s">"P"</span><span class="p">,</span>
<span class="mi">20</span><span class="p">:</span><span class="s">"Q"</span><span class="p">,</span>
<span class="mi">21</span><span class="p">:</span><span class="s">"R"</span><span class="p">,</span>
<span class="mi">22</span><span class="p">:</span><span class="s">"S"</span><span class="p">,</span>
<span class="mi">23</span><span class="p">:</span><span class="s">"T"</span><span class="p">,</span>
<span class="mi">24</span><span class="p">:</span><span class="s">"U"</span><span class="p">,</span>
<span class="mi">25</span><span class="p">:</span><span class="s">"V"</span><span class="p">,</span>
<span class="mi">26</span><span class="p">:</span><span class="s">"W"</span><span class="p">,</span>
<span class="mi">27</span><span class="p">:</span><span class="s">"X"</span><span class="p">,</span>
<span class="mi">28</span><span class="p">:</span><span class="s">"Y"</span><span class="p">,</span>
<span class="mi">29</span><span class="p">:</span><span class="s">"Z"</span><span class="p">,</span>
<span class="mi">30</span><span class="p">:</span><span class="s">"1"</span><span class="p">,</span>
<span class="mi">31</span><span class="p">:</span><span class="s">"2"</span><span class="p">,</span>
<span class="mi">32</span><span class="p">:</span><span class="s">"3"</span><span class="p">,</span>
<span class="mi">33</span><span class="p">:</span><span class="s">"4"</span><span class="p">,</span>
<span class="mi">34</span><span class="p">:</span><span class="s">"5"</span><span class="p">,</span>
<span class="mi">35</span><span class="p">:</span><span class="s">"6"</span><span class="p">,</span>
<span class="mi">36</span><span class="p">:</span><span class="s">"7"</span><span class="p">,</span>
<span class="mi">37</span><span class="p">:</span><span class="s">"8"</span><span class="p">,</span>
<span class="mi">38</span><span class="p">:</span><span class="s">"9"</span><span class="p">,</span>
<span class="mi">39</span><span class="p">:</span><span class="s">"0"</span><span class="p">,</span>
<span class="mi">40</span><span class="p">:</span><span class="s">"</span><span class="se">\n</span><span class="s">"</span><span class="p">,</span>
<span class="mi">44</span><span class="p">:</span><span class="s">" "</span><span class="p">,</span>
<span class="mi">45</span><span class="p">:</span><span class="s">"_"</span><span class="p">,</span>
<span class="mi">46</span><span class="p">:</span><span class="s">"="</span><span class="p">,</span>
<span class="mi">47</span><span class="p">:</span><span class="s">"{"</span><span class="p">,</span>
<span class="mi">48</span><span class="p">:</span><span class="s">"}"</span><span class="p">,</span>
<span class="mi">49</span><span class="p">:</span><span class="s">"|"</span><span class="p">,</span>
<span class="p">}</span>
 
<span class="n">pkts</span> <span class="o">=</span> <span class="n">rdpcap</span><span class="p">(</span><span class="s">"thekey.pcapng"</span><span class="p">)</span>
<span class="n">msg</span><span class="o">=</span> <span class="s">""</span>
<span class="k">for</span> <span class="n">packet</span> <span class="ow">in</span> <span class="n">pkts</span><span class="p">:</span>
    <span class="k">global</span> <span class="n">msg</span>
    <span class="n">hid_report</span> <span class="o">=</span> <span class="n">packet</span><span class="p">.</span><span class="n">load</span><span class="p">[</span><span class="o">-</span><span class="mi">8</span><span class="p">:]</span>
    <span class="n">key_code</span> <span class="o">=</span> <span class="nb">ord</span><span class="p">(</span><span class="n">hid_report</span><span class="p">[</span><span class="mi">2</span><span class="p">])</span>
    <span class="n">ch</span> <span class="o">=</span> <span class="n">KEY_CODES</span><span class="p">.</span><span class="n">get</span><span class="p">(</span><span class="n">key_code</span><span class="p">,</span> <span class="bp">False</span><span class="p">)</span>
    <span class="k">if</span> <span class="n">ch</span><span class="p">:</span>
        <span class="n">msg</span> <span class="o">+=</span> <span class="n">ch</span>
 
<span class="k">print</span> <span class="n">msg</span>
</pre></td></tr></tbody></table></code></pre></div></div>

<p>Sau khi decrypt mÃ¬nh nháº­n Ä‘Æ°á»£c má»™t chuá»—i khÃ¡ láº¡ Ä‘Ã³ lÃ :</p>

<blockquote>
  <p>MC3AVIIM FLAAGTTXT
ITTHE FLAAG IS CTFVBUUA{{MY_FAVORITTE_EDITOR_IS_VIM}HHHHHHHHHHHHHHHHHHHAUVI{UWQ`</p>
</blockquote>

<p>Hm, mÃ¬nh stuck á»Ÿ Ä‘oáº¡n nÃ y vÃ¬ cÃ³ thá»ƒ tÃ¡c giáº£ lÃ m gÃ¬ Ä‘Ã³ liÃªn quan tá»›i vim, tuy nhiÃªn Ä‘á»ƒ Ã½ láº¡i thÃ¬ táº¥t cáº£ Ä‘á»u clear nhÆ°ng chá»¯ FAVORITTE láº¡i sai chÃ­nh táº£ nÃªn mÃ¬nh sá»­a láº¡i vÃ  submit thá»­ sem sao. Ngáº¡c nhiÃªn lÃ  nÃ³ láº¡i Ä‘Ãºng vÃ  cÃ³ 100 Ä‘iá»ƒm.</p>

<p>Flag: CTF{MY_FAVOURITE_EDITOR_IS_VIM}</p>

<h2 id="bwf0cnlvc2hr-yq">bWF0cnlvc2hr YQ==</h2>

<p>Äá» bÃ i cho mÃ¬nh file .eml nÃªn mÃ¬nh dÃ¹ng EML Reader trong Microsoft Store Ä‘á»ƒ má»Ÿ nÃ³. Trong file Ä‘Ã­nh kÃ¨m mÃ¬nh cÃ³ 2 file lÃ  hack.pgp vÃ  Matry_Oshka.key, bÃªn cáº¡nh Ä‘Ã³ Ä‘á»“ng Ä‘á»™i mÃ¬nh sá»­ dá»¥ng notepad cÅ©ng cÃ³ tháº¥y má»™t Ä‘oáº¡n base64 vÃ  khi decrypt thÃ¬ ra má»™t áº£nh qr code cÃ³ ná»™i dung <strong>h4ck_the_plan3t</strong>.</p>

<p><img src="/assets/img/blog/BSidesSF2019-5.PNG" alt="IMG" /></p>

<p>Sá»­ dá»¥ng gpg trong linux Ä‘á»ƒ decrypt:</p>

<div class="language-bash highlighter-rouge"><div class="highlight"><pre class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
5
6
7
8
9
10
11
12
13
14
15
16
17
18
19
</pre></td><td class="rouge-code"><pre><span class="nv">$ </span>gpg <span class="nt">--import</span> Matry_Oshka.key

gpg: key 69D5F0038A289FB1: public key <span class="s2">"Matry Oshka &lt;Matry.Oshka@gmail.com&gt;"</span> imported
gpg: key 69D5F0038A289FB1: secret key imported
gpg: Total number processed: 1
gpg:               imported: 1
gpg:       secret keys <span class="nb">read</span>: 1
gpg:   secret keys imported: 1

<span class="nv">$ </span>gpg <span class="nt">--list-key</span>

pub   rsa2048 2019-03-01 <span class="o">[</span>SC] <span class="o">[</span>expires: 2021-02-28]
      0C7BCBBADF0C5273E797318069D5F0038A289FB1
uid           <span class="o">[</span> unknown] Matry Oshka &lt;Matry.Oshka@gmail.com&gt;
sub   rsa2048 2019-03-01 <span class="o">[</span>E] <span class="o">[</span>expires: 2021-02-28]

<span class="nv">$ </span>gpg <span class="nt">-o</span> out <span class="nt">--decrypt</span> hack.pgp 
gpg: encrypted with 2048-bit RSA key, ID E5CAE1F0A16B0E7A, created 2019-03-01
      <span class="s2">"Matry Oshka &lt;Matry.Oshka@gmail.com&gt;"</span>
</pre></td></tr></tbody></table></code></pre></div></div>

<p>Check thá»­ xem thÃ¬ file out lÃ  file zip</p>

<div class="language-bash highlighter-rouge"><div class="highlight"><pre class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
</pre></td><td class="rouge-code"><pre><span class="nv">$ </span>file out
out: Zip archive data, at least v2.0 to extract
</pre></td></tr></tbody></table></code></pre></div></div>

<p>Sau khi extract file zip vÃ  dÃ¹ng binwalk, mÃ¬nh tháº¥y cÃ³ má»™t file lzip á»Ÿ offset thá»© 10, tiáº¿n hÃ nh dump file vÃ  giáº£i nÃ©n mÃ¬nh cÃ³ Ä‘Æ°á»£c má»™t file pdf chá»©a áº£nh ná»n windows xp huyá»n thoáº¡i. Sau khi dÃ¹ng adobe acrobat, mÃ¬nh extract Ä‘Æ°á»£c file áº£nh ra ngoÃ i. Äoáº¡n nÃ y khÃ¡ lÃ  tiáº¿c khi trong cuá»™c thi mÃ¬nh chá»‰ extract file jpg nÃªn stuck vÃ  khÃ´ng thá»ƒ giáº£i quyáº¿t Ä‘Æ°á»£c lÃºc giáº£i diá»…n ra. Chá»‰ hÃ´m sau mÃ¬nh extract báº±ng file bitmap thÃ¬ má»›i cÃ³ thá»ƒ lÃ m Ä‘Ãºng hÆ°á»›ng khi admin nÃ³i mÃ¬nh nÃªn tra wiki áº£nh gá»‘c. DÃ¹ng stegsolve mÃ¬nh cÃ³ Ä‘Æ°á»£c 1 mÃ£ qr lá»—i.</p>

<p><img src="/assets/img/blog/BSidesSF2019-6.PNG" alt="IMG" /></p>

<p>Sau khi sá»­a láº¡i báº±ng cÃ¡ch Ä‘á»•i pixel tráº¯ng thÃ nh Ä‘en vÃ  ngÆ°á»£c láº¡i, mÃ¬nh cÃ³ Ä‘Æ°á»£c má»™t mÃ£ qr hoÃ n háº£o.</p>

<p><img src="/assets/img/blog/BSidesSF2019-7.PNG" alt="IMG" /></p>

<p>VÃ  mÃ¬nh cÃ³ Ä‘Æ°á»£c Ä‘oáº¡n base64:</p>

<blockquote>
  <p>/Td6WFoAAATm1rRGAgAhARwAAAAQz1jM4ELCAORdABhgwwZfNTLh1bKR4pwkkcJw0DSEZd2BcWATAJkrMgnKT8nBgYQaCPtrzORiOeUVq7DDoe9feCLt9PG-MT9ZCLwmtpdfvW0n17pie8v0h7RS4dO/yb7JHn7sFqYYnDWZere/6BI3AiyraCtQ6qZmYZnHemfLVXmCXHan5fN6IiJL7uJdoJBZC3Rb1hiH1MdlFQ/1uOwaoglBdswAGo99HbOhsSFS5gGqo6WQ2dzK3E7NcYP2YIQxS9BGibr4Qulc6e5CaCHAZ4pAhfLVTYoN5R7l/cWvU3mLOSPUkELK6StPUBd0AABBU17Cf970JQABgALDhQEApzo4PbHEZ/sCAAAAAARZWg==</p>
</blockquote>

<p>Decode mÃ¬nh cÃ³ Ä‘Æ°á»£c má»™t file 7zip vÃ  bÃªn trong lÃ  má»™t file text chá»©a mÃ£ nhá»‹ phÃ¢n. Decode mÃ£ nhá»‹ phÃ¢n theo cÃ¡c bÆ°á»›c:</p>
<ul>
  <li>Nhá»‹ phÃ¢n -&gt; ascii, mÃ¬nh cÃ³ Ä‘Æ°á»£c dÃ£y sá»‘</li>
  <li>BÃ¡t phÃ¢n -&gt; tháº­p phÃ¢n</li>
  <li>Tháº­p phÃ¢n -&gt; ascii cÃ³ Ä‘Æ°Æ¡c mÃ£ hex</li>
  <li>Tá»« hex -&gt; base 64</li>
  <li>Tá»­ base 64 -&gt; base 85</li>
  <li>Tá»« base 85 -&gt; flag</li>
</ul>

<p><img src="/assets/img/blog/BSidesSF2019-8.PNG" alt="IMG" /></p>

<h2 id="zippy">Zippy</h2>

<p>File pcap cho mÃ¬nh biáº¿t Ä‘Æ°á»£c cÃ¢u lá»‡nh unzip file flag.zip. VÃ  file flag.zip Ä‘Æ°á»£c lÆ°u tá»« gÃ³i tin thá»© 6 dáº¿n gÃ³i tin thá»© 13. Extract file zip vÃ  giáº£i nÃ©n vá»›i password: supercomplexpassword, mÃ¬nh cÃ³ Ä‘Æ°á»£c flag.</p>

<p>Flag: CTF{this_flag_is_your_flag}</p>
:ET